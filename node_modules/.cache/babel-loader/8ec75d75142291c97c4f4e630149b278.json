{"ast":null,"code":"import _objectSpread from\"/Users/jackjoliet/Documents/marketplace/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{apiCall}from\"../../services/api\";import jwt_decode from\"jwt-decode\";import setAuthToken from\"../../utils/setAuthToken\";import{GET_ERRORS,SET_CURRENT_USER,USER_LOADING}from\"../types\";// Login - get user token\nexport var loginUser=function loginUser(userData){return function(dispatch){return apiCall('post',\"/api/login/admin\",userData).then(function(res){var token=res.token;localStorage.setItem(\"jwtToken\",token);// Set token to Auth header\nsetAuthToken(token);// Decode token to get user data\nvar decoded=jwt_decode(token);return apiCall('get',\"/api/admin/\".concat(decoded.id)).then(function(res){// Set current user\ndispatch(setCurrentAdmin(_objectSpread({},decoded,{},res[0])));return{complete:true};}).catch(function(err){console.log(err);return{complete:false,message:err.data.error};});}).catch(function(err){console.log(err);return{complete:false,message:err.data.error};});};};// Set logged in user\nexport var setCurrentAdmin=function setCurrentAdmin(decoded){return{type:SET_CURRENT_USER,payload:decoded};};// User loading\nexport var setUserLoading=function setUserLoading(){return{type:USER_LOADING};};// Log user out\nexport var logoutAdmin=function logoutAdmin(){return function(dispatch){// Remove token from local storage\nlocalStorage.removeItem(\"jwtToken\");// Remove auth header for future requests\nsetAuthToken(false);// Set current user to empty object {} which will set isAuthenticated to false\ndispatch(setCurrentAdmin({}));};};","map":{"version":3,"sources":["/Users/jackjoliet/Documents/marketplace/front/src/store/actions/adminauth.js"],"names":["apiCall","jwt_decode","setAuthToken","GET_ERRORS","SET_CURRENT_USER","USER_LOADING","loginUser","userData","dispatch","then","res","token","localStorage","setItem","decoded","id","setCurrentAdmin","complete","catch","err","console","log","message","data","error","type","payload","setUserLoading","logoutAdmin","removeItem"],"mappings":"mKAAA,OAAQA,OAAR,KAAsB,oBAAtB,CACA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CACA,MAAOC,CAAAA,YAAP,KAAyB,0BAAzB,CAEA,OAAQC,UAAR,CAAoBC,gBAApB,CAAsCC,YAAtC,KAAyD,UAAzD,CAEA;AACA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAAC,QAAQ,QAAI,UAAAC,QAAQ,CAAI,CAC/C,MAAOR,CAAAA,OAAO,CAAC,MAAD,oBAA6BO,QAA7B,CAAP,CACNE,IADM,CACD,SAASC,GAAT,CAAc,CAClB,GAAMC,CAAAA,KAAK,CAAGD,GAAG,CAACC,KAAlB,CACAC,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAiCF,KAAjC,EACA;AACAT,YAAY,CAACS,KAAD,CAAZ,CACA;AACA,GAAMG,CAAAA,OAAO,CAAGb,UAAU,CAACU,KAAD,CAA1B,CAEA,MAAOX,CAAAA,OAAO,CAAC,KAAD,sBAAsBc,OAAO,CAACC,EAA9B,EAAP,CACNN,IADM,CACD,SAASC,GAAT,CAAc,CAClB;AACAF,QAAQ,CAACQ,eAAe,kBAAKF,OAAL,IAAiBJ,GAAG,CAAC,CAAD,CAApB,EAAhB,CAAR,CACA,MAAO,CAACO,QAAQ,CAAE,IAAX,CAAP,CACD,CALM,EAMNC,KANM,CAMA,SAASC,GAAT,CAAc,CACnBC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACA,MAAO,CAACF,QAAQ,CAAE,KAAX,CAAkBK,OAAO,CAAEH,GAAG,CAACI,IAAJ,CAASC,KAApC,CAAP,CACD,CATM,CAAP,CAWD,CApBM,EAqBNN,KArBM,CAqBA,SAASC,GAAT,CAAc,CACnBC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACA,MAAO,CAACF,QAAQ,CAAE,KAAX,CAAkBK,OAAO,CAAEH,GAAG,CAACI,IAAJ,CAASC,KAApC,CAAP,CACD,CAxBM,CAAP,CAyBD,CA1BgC,EAA1B,CA2BP;AACA,MAAO,IAAMR,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAAAF,OAAO,CAAI,CACxC,MAAO,CACLW,IAAI,CAAErB,gBADD,CAELsB,OAAO,CAAEZ,OAFJ,CAAP,CAID,CALM,CAMP;AACA,MAAO,IAAMa,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAClC,MAAO,CACLF,IAAI,CAAEpB,YADD,CAAP,CAGD,CAJM,CAKP;AACA,MAAO,IAAMuB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,SAAM,UAAApB,QAAQ,CAAI,CAC3C;AACAI,YAAY,CAACiB,UAAb,CAAwB,UAAxB,EACA;AACA3B,YAAY,CAAC,KAAD,CAAZ,CACA;AACAM,QAAQ,CAACQ,eAAe,CAAC,EAAD,CAAhB,CAAR,CACD,CAP0B,EAApB","sourcesContent":["import {apiCall} from \"../../services/api\";\nimport jwt_decode from \"jwt-decode\";\nimport setAuthToken from \"../../utils/setAuthToken\";\n\nimport {GET_ERRORS, SET_CURRENT_USER, USER_LOADING} from \"../types\";\n\n// Login - get user token\nexport const loginUser = userData => dispatch => {\n  return apiCall('post', `/api/login/admin`, userData)\n  .then(function(res) {\n    const token = res.token;\n    localStorage.setItem(\"jwtToken\", token);\n    // Set token to Auth header\n    setAuthToken(token);\n    // Decode token to get user data\n    const decoded = jwt_decode(token);\n\n    return apiCall('get', `/api/admin/${decoded.id}`)\n    .then(function(res) {\n      // Set current user\n      dispatch(setCurrentAdmin({...decoded, ...res[0]}));\n      return {complete: true};\n    })\n    .catch(function(err) {\n      console.log(err);\n      return {complete: false, message: err.data.error};\n    });\n\n  })\n  .catch(function(err) {\n    console.log(err);\n    return {complete: false, message: err.data.error};\n  });\n};\n// Set logged in user\nexport const setCurrentAdmin = decoded => {\n  return {\n    type: SET_CURRENT_USER,\n    payload: decoded\n  };\n};\n// User loading\nexport const setUserLoading = () => {\n  return {\n    type: USER_LOADING\n  };\n};\n// Log user out\nexport const logoutAdmin = () => dispatch => {\n  // Remove token from local storage\n  localStorage.removeItem(\"jwtToken\");\n  // Remove auth header for future requests\n  setAuthToken(false);\n  // Set current user to empty object {} which will set isAuthenticated to false\n  dispatch(setCurrentAdmin({}));\n};"]},"metadata":{},"sourceType":"module"}