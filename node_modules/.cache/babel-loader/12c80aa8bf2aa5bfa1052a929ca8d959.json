{"ast":null,"code":"import _objectSpread from \"/Users/jackjoliet/Documents/marketplace/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport { SET_CURRENT_USER, GET_ADMIN_DATA, UPDATE_ADMIN_DATA } from \"../types\";\nimport empty from 'is-empty';\nimport { saveAs } from 'file-saver';\nimport { apiCall } from '../../services/api';\nimport { flatten } from 'flat';\nexport const state_get_admin = payload => ({\n  type: SET_CURRENT_USER,\n  payload\n});\nexport const state_get_admin_data = payload => ({\n  type: GET_ADMIN_DATA,\n  payload\n});\nexport const state_update_admin_data = payload => ({\n  type: UPDATE_ADMIN_DATA,\n  payload\n});\nexport const db_get_admin = user => dispatch => {\n  return apiCall('get', `/api/admin/${user.id}`).then(function (res) {\n    dispatch(state_get_admin(_objectSpread({}, user, {}, res[0])));\n    return {\n      complete: true\n    };\n  }).catch(function (err) {\n    return {\n      complete: false,\n      message: err\n    };\n  });\n};\nexport const db_admin_get_customers = data => dispatch => {\n  return apiCall('post', `/api/admin/customers`, data).then(function (res) {\n    dispatch(state_get_admin_data(res));\n    return {\n      complete: true\n    };\n  }).catch(function (err) {\n    return {\n      complete: false,\n      message: err\n    };\n  });\n};\nexport const db_admin_get_workers = data => dispatch => {\n  return apiCall('post', `/api/admin/workers`, data).then(function (res) {\n    dispatch(state_get_admin_data(res));\n    return {\n      complete: true\n    };\n  }).catch(function (err) {\n    return {\n      complete: false,\n      message: err\n    };\n  });\n};\nexport const db_admin_get_jobs = data => dispatch => {\n  return apiCall('post', `/api/admin/jobs`, data).then(function (res) {\n    dispatch(state_get_admin_data(res.map(item => _objectSpread({}, item, {\n      customer: empty(JSON.parse(item.customer)) ? null : JSON.parse(item.customer)[0],\n      worker_list: JSON.parse(item.worker_list),\n      payment: empty(JSON.parse(item.payment)) ? null : JSON.parse(item.payment)[0]\n    }))));\n    return {\n      complete: true\n    };\n  }).catch(function (err) {\n    return {\n      complete: false,\n      message: err\n    };\n  });\n};\nexport const db_get_export_file = file_name => dispatch => {\n  return apiCall('get', `/api/admin/export`, {\n    responseType: 'blob'\n  }).then(function (res) {\n    saveAs(res, `${file_name}.xlsx`);\n    return {\n      complete: true\n    };\n  }).catch(function (err) {\n    console.log(err);\n    return {\n      complete: false,\n      message: err\n    };\n  });\n};\nexport const db_export_table = (table, location, file_name) => dispatch => {\n  return apiCall('post', `/api/admin/export`, {\n    table: table,\n    location: location\n  }).then(function (res) {\n    dispatch(db_get_export_file(file_name));\n    return {\n      complete: true\n    };\n  }).catch(function (err) {\n    return {\n      complete: false,\n      message: err\n    };\n  });\n};\nexport const db_update_worker_active = data => dispatch => {\n  return apiCall('put', `/api/admin/worker/status`, data).then(function (res) {\n    dispatch(state_update_admin_data(data));\n    return {\n      complete: true\n    };\n  }).catch(function (error) {\n    return {\n      complete: false,\n      message: error.data.error\n    };\n  });\n};","map":{"version":3,"sources":["/Users/jackjoliet/Documents/marketplace/front/src/store/actions/admin.js"],"names":["SET_CURRENT_USER","GET_ADMIN_DATA","UPDATE_ADMIN_DATA","empty","saveAs","apiCall","flatten","state_get_admin","payload","type","state_get_admin_data","state_update_admin_data","db_get_admin","user","dispatch","id","then","res","complete","catch","err","message","db_admin_get_customers","data","db_admin_get_workers","db_admin_get_jobs","map","item","customer","JSON","parse","worker_list","payment","db_get_export_file","file_name","responseType","console","log","db_export_table","table","location","db_update_worker_active","error"],"mappings":"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","sourcesContent":["import {SET_CURRENT_USER, GET_ADMIN_DATA, UPDATE_ADMIN_DATA} from \"../types\";\nimport empty from 'is-empty';\nimport {saveAs} from 'file-saver';\nimport {apiCall} from '../../services/api';\nimport {flatten} from 'flat';\n\nexport const state_get_admin = payload => ({\n\ttype: SET_CURRENT_USER,\n\tpayload\n});\n\nexport const state_get_admin_data = payload => ({\n\ttype: GET_ADMIN_DATA,\n\tpayload\n});\n\nexport const state_update_admin_data = payload => ({\n\ttype: UPDATE_ADMIN_DATA,\n\tpayload\n});\n\nexport const db_get_admin = user => dispatch => {\n\treturn apiCall('get', `/api/admin/${user.id}`)\n\t.then(function(res) {\n\t\tdispatch(state_get_admin({...user, ...res[0]}));\n\t\treturn {complete: true};\n\t})\n\t.catch(function(err) {\n\t\treturn {complete: false, message: err};\n\t});\n}\n\nexport const db_admin_get_customers = data => dispatch => {\n\treturn apiCall('post', `/api/admin/customers`, data)\n\t.then(function(res) {\n\t\tdispatch(state_get_admin_data(res));\n\t\treturn {complete: true};\n\t})\n\t.catch(function(err) {\n\t\treturn {complete: false, message: err};\n\t});\n}\n\nexport const db_admin_get_workers = data => dispatch => {\n\treturn apiCall('post', `/api/admin/workers`, data)\n\t.then(function(res) {\n\t\tdispatch(state_get_admin_data(res));\n\t\treturn {complete: true};\n\t})\n\t.catch(function(err) {\n\t\treturn {complete: false, message: err};\n\t});\n}\n\nexport const db_admin_get_jobs = data => dispatch => {\n\treturn apiCall('post', `/api/admin/jobs`, data)\n\t.then(function(res) {\n\t\tdispatch(state_get_admin_data(res.map(item => ({...item, customer: empty(JSON.parse(item.customer)) ? null : JSON.parse(item.customer)[0], worker_list: JSON.parse(item.worker_list), payment: empty(JSON.parse(item.payment)) ? null : JSON.parse(item.payment)[0]}))));\n\t\treturn {complete: true};\n\t})\n\t.catch(function(err) {\n\t\treturn {complete: false, message: err};\n\t});\n}\n\nexport const db_get_export_file = (file_name) => dispatch => {\n\treturn apiCall('get', `/api/admin/export`, { responseType: 'blob' })\n\t.then(function(res) {\n\t\tsaveAs(res, `${file_name}.xlsx`);\n\t\treturn {complete: true};\n\t})\n\t.catch(function(err) {\n\t\tconsole.log(err);\n\t\treturn {complete: false, message: err};\n\t});\n}\n\nexport const db_export_table = (table, location, file_name) => dispatch => {\n\treturn apiCall('post', `/api/admin/export`, { table: table, location: location })\n\t.then(function(res) {\n\t\tdispatch(db_get_export_file(file_name));\n\t\treturn {complete: true};\n\t})\n\t.catch(function(err) {\n\t\treturn {complete: false, message: err};\n\t});\n}\n\nexport const db_update_worker_active = data => dispatch => {\n\treturn apiCall('put', `/api/admin/worker/status`, data)\n\t.then(function(res) {\n\t\tdispatch(state_update_admin_data(data));\n\t\treturn {complete: true};\n\t})\n\t.catch(function(error) {\n\t\treturn {complete: false, message: error.data.error};\n\t});\n}\n\n"]},"metadata":{},"sourceType":"module"}